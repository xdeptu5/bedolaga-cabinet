name: Auto Sync Fork

on:
  schedule:
    - cron: '0 * * * *' # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å
  workflow_dispatch: # –ß—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–Ω–æ–ø–∫–æ–π

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      # –®–ê–ì 1: –≠—Ç–æ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ! –°–∫–∞—á–∏–≤–∞–µ–º —Ç–≤–æ—é —Ä–µ–ø—É, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –æ—à–∏–±–∫–∏ 128
      - name: Checkout target repo
        uses: actions/checkout@v4

      # –®–ê–ì 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è v3.4.1
      - name: Sync with Upstream
        uses: aormsby/Fork-Sync-With-Upstream-action@v3.4.1
        with:
          target_repo_token: ${{ secrets.GITHUB_TOKEN }}
          upstream_sync_repo: BEDOLAGA-DEV/bedolaga-cabinet
          target_sync_branch: main
          upstream_sync_branch: main
          test_mode: false

      # –®–ê–ì 3: –ï—Å–ª–∏ –≤–¥—Ä—É–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞ (–∫–æ–Ω—Ñ–ª–∏–∫—Ç) ‚Äî –±–æ—Ç –Ω–∞–ø–∏—à–µ—Ç —Ç–µ–±–µ
      - name: Send Sync Error to Telegram
        if: failure()
        run: |
          MESSAGE="<b>Safexess VPN Bot</b>%0A‚ùå <b>Sync Failed</b>%0A%0Aüì¶ <b>Repository:</b> ${{ github.repository }}%0A‚ö†Ô∏è <b>Status:</b> –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã!"
          
          curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d "message_thread_id=${{ secrets.TELEGRAM_TOPIC_ID }}" \
          -d "parse_mode=HTML" \
          -d "text=$MESSAGE"
